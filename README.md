# QuickMask - 快速图像分割标注工具

**QuickMask** 是一款轻量级、高效、直观的桌面应用程序，专为计算机视觉开发者和研究人员设计，用于快速创建和编辑像素级图像分割掩码（Mask）。

它通过模拟“画图”软件的交互方式，将复杂的像素标注任务变得简单而流畅。无论您是在进行数据集准备，还是需要对模型输出进行微调，QuickMask 都能成为您的得力助手。

---

## ✨ 功能特性

*   **直观的绘制体验**:
    *   使用可调节大小的圆形笔刷进行绘制和擦除。
    *   鼠标左键绘制，右键擦除。
    *   快速移动鼠标可形成平滑、连续的标注轨迹。

*   **高效的快捷键操作**:
    *   **图片切换**: `A` (上一张) / `D` (下一张)。
    *   **类别切换**: 数字键 `1`, `2`, `3` 对应不同标注类别。
    *   **视图控制**: `W` (放大) / `S` (缩小)，以鼠标为中心进行缩放。
    *   **视图拖动**: 按住鼠标**中键**拖动。
    *   **历史记录**: `Ctrl + Z` 撤销上一步操作。
    *   **自动标注**: `R` 切换到矩形选择模式，按住鼠标左键绘制矩形区域进行快速标注。
    *   **文件操作**:
        *   `Ctrl + S` 手动保存当前掩码。
        *   `X` 删除当前图片的掩码。
        *   `Delete` 永久删除当前图片及其掩码（**请谨慎使用！**）。

*   **智能文件管理**:
    *   启动时自动加载 `images/` 文件夹下的所有图片。
    *   自动加载 `masks/` 文件夹中已存在的同名掩码。
    *   切换图片或关闭软件时**自动保存**标注。
    *   智能避免创建空的（全黑的）掩码文件，保持项目整洁。

*   **便捷的进度导航**:
    *   底部进度条实时显示标注进度。
    *   支持拖动进度条或在输入框中输入数字快速跳转。
    *   进度条下方有状态指示条，红色代表未标注，绿色代表已存在掩码。

*   **清晰的状态反馈**:
    *   状态栏实时显示当前**类别**、**笔刷大小**和**缩放级别**。
    *   删除操作前会有安全确认对话框。

---

## 🚀 快速开始

### 1. 环境准备

确保您的系统已安装 **Python 3.x**。

### 2. 安装依赖

打开终端或命令行，使用 pip 安装必要的库：

```bash
pip install PyQt5 opencv-python numpy
```

### 3. 项目设置

1.  克隆或下载此项目到您的本地计算机。
2.  在项目根目录下，创建一个名为 `images` 的文件夹。
3.  将您所有待标注的图片（`.jpg`, `.png` 等格式）放入 `images` 文件夹中。

项目结构应如下所示：

```
quickmask_project/
├── main.py
├── app_state.py
├── annotation_canvas.py
├── main_window.py
├── README.md
└── images/
    ├── 001.jpg
    ├── 002.png
    └── ...
```

`masks` 文件夹将在您第一次进行标注并保存时自动创建。

### 4. 运行软件

在项目根目录下，运行主程序：

```bash
python main.py
```

---

## 📝 标注流程

1.  启动软件后，第一张图片和其对应的掩码（如果存在）会自动加载。
2.  使用**鼠标滚轮**调整笔刷大小。
3.  按数字键 `1`, `2` 或 `3` 选择要标注的类别。
4.  按住**鼠标左键**在目标区域上绘制，进行标注。
5.  按住**鼠标右键**擦除错误的标注。
6.  使用 `W/S` 键和鼠标中键调整视图，进行精细标注。
7.  完成当前图片后，按 `D` 键切换到下一张。您的标注会自动保存。
8.  所有标注的掩码图将以单通道 PNG 格式保存在 `masks` 文件夹下，文件名与原图保持一致。类别 `1`, `2`, `3` 分别对应掩码图中的像素值 `1`, `2`, `3`。
9.  如果需要删除当前图片的掩码，按 `X` 键进行确认删除。
10. 如果需要永久删除当前图片及其掩码，按 `Delete` 键进行确认。
11. 使用 `Ctrl + S` 手动保存当前掩码。
12. 使用 `Ctrl + Z` 撤销上一步操作。
13. 按 `R` 键切换到矩形选择模式，按住鼠标左键绘制矩形区域进行自动标注。


## 📜 许可

本项目采用 [MIT License](LICENSE)。

